
image: joyzoursky/python-chromedriver:latest

variables:
  PIP_CACHE_DIR: "$CI_PROJECT_DIR/.cache/pip"

cache:
  paths:
    - .cache/pip
    - venv/

run:
  script:
  - apt update
  - apt install firefox
  - wget https://github.com/mozilla/geckodriver/releases/download/v0.23.0/geckodriver-v0.23.0-linux64.tar.gz
  - sh -c 'tar -x geckodriver -zf geckodriver-v0.23.0-linux64.tar.gz -O > /usr/bin/geckodriver'
  - chmod +x /usr/bin/geckodriver
  - rm geckodriver-v0.23.0-linux64.tar.gz
  - python3 -V
  - pip install virtualenv
  - virtualenv venv
  - source venv/bin/activate
  - pip install -r requirements.txt
  - python -m pytest ./tests
  artifacts:
    paths:
    - ./tests/logs/report
